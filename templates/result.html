<!DOCTYPE html>
<html lang="en"> <!-- กำหนดภาษาเริ่มต้นเป็นภาษาอังกฤษ -->
<head>
    <meta charset="UTF-8"> <!-- กำหนดชุดตัวอักษรเป็น UTF-8 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- ตั้งค่าให้หน้าเว็บแสดงผลได้ดีในอุปกรณ์ต่างๆ -->
    <title>Test Results</title> <!-- กำหนดชื่อหัวข้อของหน้าเว็บ -->
    <link rel="stylesheet" href="/static/style.css"> <!-- ลิงก์ไฟล์ CSS สำหรับการจัดแต่งสไตล์ -->
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/1802/1802511.png"> <!-- ตั้งค่า favicon สำหรับหน้าเว็บ -->
    <style>
        body { /* การจัดการสไตล์สำหรับ body */
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background-color: #aee4fc;
            overflow-y: scroll; /* ให้สามารถเลื่อนหน้าเว็บในแนวตั้งได้ */
        }

        .container { /* การจัดการสไตล์สำหรับคอนเทนเนอร์หลัก */
            max-width: 900px;
            max-height: fit-content;
            margin: auto;
            padding: 20px 10px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        h2 { /* การจัดการสไตล์สำหรับหัวข้อใหญ่ */
            text-align: center;
            margin-top: 0px;
            margin-bottom: 30px;
            font-size: 2rem;
        }

        h3 { /* การจัดการสไตล์สำหรับหัวข้อย่อย */
            text-align: center;
            margin-bottom: 30px;
            font-size: 1.5rem;
        }

        .result { /* การจัดการสไตล์สำหรับส่วนแสดงผลลัพธ์ */
            text-align: center;
            margin-bottom: 30px;
        }

        .result img { /* การจัดการสไตล์สำหรับรูปภาพในส่วนผลลัพธ์ */
            width: auto;
            height: auto;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .result-summary { /* การจัดการสไตล์สำหรับสรุปผลลัพธ์ */
            display: flex;
            justify-content: space-around;
            font-size: 1.2rem;
            margin-top: 20px;
            text-justify: auto;
        }

        .precautions { /* การจัดการสไตล์สำหรับส่วนข้อควรระวัง */
            margin-top: 40px;
        }

        .precautions-grid { /* การจัดการสไตล์สำหรับกริดของข้อควรระวัง */
            display: grid;
            grid-template-columns: repeat(3, 1fr); /* ตั้งค่าเป็นกริดที่มี 3 คอลัมน์ */
            gap: 10px;
            margin-top: 10px;
        }

        /* สไตล์สำหรับหน้าจอที่มีความกว้างไม่เกิน 600px (เช่น โทรศัพท์มือถือ) */
        @media (max-width: 600px) {
            .precautions-grid {
                grid-template-columns: repeat(2, 1fr); /* เปลี่ยนเป็น 2 คอลัมน์สำหรับหน้าจอเล็ก */
            }
        }

        .result-summary-grid { /* การจัดการสไตล์สำหรับกริดสรุปผลลัพธ์ */
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* ตั้งค่าเป็นกริดที่มี 2 คอลัมน์ */
            gap: 20px;
            margin-top: 20px;
        }

        .precaution-item { /* การจัดการสไตล์สำหรับข้อควรระวังแต่ละรายการ */
            text-align: center;
            padding: 10px;
            background-color: #aee4fc;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .item { /* การจัดการสไตล์สำหรับไอเทมสรุปผลลัพธ์ */
            text-align: center;
            padding-bottom: 20px;
            background-color: #aee4fc;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .more-about { /* การจัดการสไตล์สำหรับส่วนข้อมูลเพิ่มเติม */
            text-align: center;
            padding: 10px;
            margin-bottom: 20px;
            background-color: #aee4fc;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .button { /* การจัดการสไตล์สำหรับปุ่มต่างๆ */
            text-align: center;
            padding: 10px;
            background-color: #aee4fc;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .precaution-item img { /* การจัดการสไตล์สำหรับรูปภาพในข้อควรระวัง */
            width: 50px;
            margin-bottom: 10px;
        }

        .back-button, #toggle-lang { /* การจัดการสไตล์สำหรับปุ่มกลับและปุ่มเปลี่ยนภาษา */
            padding: 10px 20px;
            background-color: #aee4fc;
            border-radius: 8px;
            text-decoration: none;
            color: #333;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            text-align: center;
            font-size: 1rem;
            min-width: 100px; /* กำหนดให้ทั้งสองปุ่มมีขนาดขั้นต่ำเท่ากัน */
        }

        .back-button:hover, #toggle-lang:hover { /* สไตล์เมื่อเอาเมาส์ไปวางบนปุ่ม */
            box-shadow: 0 3px 7px rgba(0, 0, 0, 0.15);
        }

        .header { /* การจัดการสไตล์สำหรับส่วนหัวของหน้า */
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .left, .language-toggle { /* สไตล์สำหรับตำแหน่งซ้ายและปุ่มเปลี่ยนภาษา */
            display: inline-block;
        }

        .language-toggle button { /* สไตล์สำหรับปุ่มเปลี่ยนภาษา */
            padding: 8px 16px;
            background-color: #aee4fc;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            color: #333;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .language-toggle button:hover { /* สไตล์เมื่อเอาเมาส์ไปวางบนปุ่มเปลี่ยนภาษา */
            box-shadow: 0 3px 7px rgba(0, 0, 0, 0.15);
        }

        #caution { /* สไตล์สำหรับข้อความเตือน */
            color: red;
        }

    </style>
</head>
<body>
    <div class="container" data-predicted-index="{{ predicted_class_index }}"> <!-- คอนเทนเนอร์หลักที่แสดงผลลัพธ์ พร้อมตั้งค่าดัชนีคลาส -->
        <div class="header">
            <div class="left">
                <a href="/" class="back-button">← Back</a> <!-- ปุ่มกลับไปหน้าแรก -->
            </div>
            <div class="language-toggle">
                <button id="toggle-lang">TH</button> <!-- ปุ่มเปลี่ยนภาษา -->
            </div>
        </div>
        <h2>Test Results Summary</h2> <!-- หัวข้อสรุปผลลัพธ์ -->
        <div class="result">
            <img id="predicted-image" src="data:image/png;base64,{{ picture }}" alt="Predicted Skin Condition"> <!-- แสดงภาพที่พยากรณ์ -->
            <div class="result-summary result-summary-grid">
                <div class="item" id="prediction">
                    <p>Prediction</p> <!-- ข้อความ "Prediction" -->
                    <strong id="prediction-text"></strong> <!-- ผลลัพธ์การพยากรณ์จะแสดงที่นี่ -->
                </div>
                <div class="item">
                    <p>Confidence</p> <!-- ข้อความ "Confidence" -->
                    <strong>{{ predicted_prob }}</strong> <!-- แสดงค่าความมั่นใจในผลลัพธ์ -->
                </div>
            </div>
        </div>
        <div class="precautions">
            <div class="more-about">
                <h3>More About <span id="condition-title"></span></h3> <!-- หัวข้อข้อมูลเพิ่มเติมเกี่ยวกับโรค -->
                <p id="more-info"></p> <!-- ข้อความข้อมูลเพิ่มเติมจะแสดงที่นี่ -->
                <p id="caution"></p> <!-- ข้อความเตือนจะแสดงที่นี่ -->
            </div>
            <hr>
            <div class="precautions-header">
                <h3>Precautions</h3> <!-- หัวข้อ "Precautions" -->
            </div>
            <div class="precautions-grid" id="precautions-list"> <!-- กริดสำหรับรายการข้อควรระวัง -->
                <!-- รายการข้อควรระวังจะถูกเพิ่มโดย dynamic ผ่าน JavaScript -->
            </div>
        </div>
    </div>

    <script>
        let currentLang = 'en'; // กำหนดภาษาหลักเริ่มต้นเป็นภาษาอังกฤษ
        const predictedClassIndex = document.querySelector('.container').dataset.predictedIndex; // ดึงดัชนีของคลาสที่พยากรณ์ได้จาก attribute ของ container
    
        fetch('/static/data.json') // เรียกข้อมูลจากไฟล์ JSON
            .then(response => response.json()) // แปลงข้อมูลที่ได้เป็น JSON
            .then(data => {
                const classNames = data.class_names; // เก็บข้อมูลชื่อคลาสตามภาษา
                const moreInfos = data.moreInfos; // เก็บข้อมูลเพิ่มเติมของแต่ละคลาส
                const precautions = data.precautions; // เก็บข้อมูลข้อควรระวัง
                const translations = data.translations; // เก็บข้อความแปลตามภาษา
    
                // ฟังก์ชันสำหรับอัปเดตเนื้อหาตามภาษาที่เลือก
                function updateContent() {
                    document.getElementById('prediction-text').textContent = classNames[currentLang][predictedClassIndex]; // อัปเดตชื่อคลาสที่พยากรณ์ได้
                    document.getElementById('more-info').textContent = moreInfos[currentLang][predictedClassIndex]; // อัปเดตข้อมูลเพิ่มเติม
                    document.getElementById('caution').textContent = translations[currentLang].caution; // อัปเดตข้อความเตือน
                    document.querySelector('.container h2').textContent = translations[currentLang].test_results_summary; // อัปเดตหัวข้อสรุปผลลัพธ์
                    document.querySelector('#prediction p').textContent = translations[currentLang].prediction; // อัปเดตข้อความ "Prediction"
                    document.querySelector('.result-summary .item:nth-child(2) p').textContent = translations[currentLang].confidence; // อัปเดตข้อความ "Confidence"
                    document.querySelector('.more-about h3').textContent = `${translations[currentLang].more_about} ${classNames[currentLang][predictedClassIndex]}`; // อัปเดตหัวข้อข้อมูลเพิ่มเติม
                    document.querySelector('.precautions-header h3').textContent = translations[currentLang].precautions; // อัปเดตข้อความ "Precautions"
                    document.querySelector('.back-button').textContent = translations[currentLang].back; // อัปเดตข้อความปุ่มกลับ

                    // สร้างรายการข้อควรระวัง
                    const precautionsList = document.getElementById('precautions-list');
                    precautionsList.innerHTML = ''; // ล้างรายการปัจจุบัน
    
                    precautions[currentLang].forEach((item, index) => { // ลูปเพื่อสร้างข้อควรระวังตามภาษา
                        const precautionItem = document.createElement('div'); // สร้าง div สำหรับแต่ละข้อควรระวัง
                        precautionItem.className = 'precaution-item'; // กำหนดคลาสสไตล์
                        precautionItem.innerHTML = `
                            <img src="${item.img}" alt="${item.heading}">
                            <h4 class="precaution-heading">${item.heading}</h4>
                            <p class="precaution-info">${item.moreInfo}</p>
                        `;
                        precautionsList.appendChild(precautionItem); // เพิ่มข้อควรระวังเข้าไปในกริด
                    });
                }
    
                // โหลดเนื้อหาครั้งแรก
                updateContent();
    
                // จัดการเมื่อเปลี่ยนภาษา
                document.getElementById('toggle-lang').addEventListener('click', () => {
                    currentLang = currentLang === 'en' ? 'th' : 'en'; // สลับภาษาระหว่างอังกฤษกับไทย
                    document.getElementById('toggle-lang').textContent = currentLang === 'en' ? 'TH' : 'EN'; // อัปเดตข้อความบนปุ่มเปลี่ยนภาษา
                    updateContent(); // อัปเดตเนื้อหาตามภาษาที่เปลี่ยน
                });
            });
    </script>
    
</body>
</html>